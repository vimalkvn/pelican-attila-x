{% extends "base.html" %}

{% block title %}{{ page.title }}{% endblock title %}

{% block canonical_url %}
<link href="{{ SITEURL }}/{{ page.url }}" rel="canonical" />
{% endblock canonical_url %}

{# <!-- Choosing cover image --> #}
{% set selected_cover = "" %}
{% if page.cover %}
    {% set selected_cover = SITEURL + "/" + page.cover %}
{% elif page.og_image %}
    {% set selected_cover = SITEURL + "/" + page.og_image %}
{% elif COVER_IMAGES and "page" in COVER_IMAGES %}
  {% set selected_cover = SITEURL + "/" + COVER_IMAGES["page"] %}
{% endif %}




{% block header %}
  <header {%if selected_cover %}class="post-header has-cover"{% else %}class="post-header"{% endif %}>
      <div class="inner">
        <h1 class="post-title">{{ page.title }}</h1>
        {% if selected_cover %}
            <div class="post-cover cover">
              <img src="{{ selected_cover }}" alt="{{ page.title }}" />
            </div>
        {% endif %}
      </div>
    </header>
{% endblock header %}

{% block content %}
  <main class="content" role="main">
      <article class="post">
      <div class="inner">
          <section class="post-content">
              {{page.content}}
          </section>
          {% block share_section %}{% endblock %}
      </div>
      </article>
  </main>
{% endblock content %}
{% block scripts %}
<script>
  $(document).ready(function () {
		var post = $('.post-content');
		// Responsive videos with fitVids
    post.fitVids();
		// Format code blocks and add line numbers
		function codestyling() {
	    $('pre code').each(function(i, e) {
        // Only add line numbers to code segments. Syntax highlight is done 
        // already using Pygments
	      // No lines for plain text blocks
	      if (!$(this).hasClass('language-text')) {
	        var code = $(this);
					// Calculate amount of lines
	        var lines = code.html().split(/\n(?!$)/g).length;
	        var numbers = [];
	        if (lines > 1) {
	          lines++;
	        }
	        for (i = 1; i < lines; i++) {
	          numbers += '<span class="line" aria-hidden="true">' + i + '</span>';
	        }
	        code.parent().append('<div class="lines">' + numbers + '</div>');
	      }
	    });
	  }
	  codestyling();
  });
</script>
{% endblock scripts %}
